$(function(){var e,i,a,r=$("#user-regh"),t=$(".ui-tab-panel",r),s=$("form.reg-form",r),o=$("form.login-form",r);$("img.validcode, a.refresh-code",o).bind("click",function(){return $("img.validcode",o).attr("src","/image/randomcode4Login/?"+Math.random()),!1}),LT.File.Js.load("http://core.pc.lietou-static.com/revs/js/common/plugins/jquery.simpleValidTips_aef0278d.js,http://core.pc.lietou-static.com/revs/js/common/plugins/jquery.valid_cbce39ff.js,http://core.pc.lietou-static.com/revs/js/common/plugins/jquery.placeholderui_4ea8db00.js",function(){s.PlaceholderUI(),$("[data-selector=email]",s).bind("blur",function(){var e=$.trim($(this).val()),i=$(this);$.ajax({url:LT.Env.wwwRoot+"user/isuserexist/",type:"POST",data:{user_login:e,user_kind:2},dataType:"json",cache:!1,success:function(e){1==e&&i.SimpleValidErrorTips("该邮箱已注册，请更换邮箱")}})}),$('[data-selector="mobile"]',s).bind("blur",function(){var e=$.trim($(this).val()),i=$(this);$.ajax({url:LT.Env.wwwRoot+"user/isuserhtelexist/",type:"POST",data:{tel:e},dataType:"json",cache:!1,success:function(e){1==e.flag&&e.status&&i.SimpleValidErrorTips("该手机号已注册，请更换号码")}})}),s.valid({type:{name:"change",callback:function(e){var i=$(this).closest(".valid-row");i.find(".valid-tips-error").remove(),!e.valid&&$('<span class="valid-tips-error"><i class="icon-16 icon-danger"></i>'+e.customErrorMsg+"</span>").appendTo(i)}},scan:function(e){e.valid?s.find(".text-error").removeClass("text-error"):($.each(e.result,function(e,i){!i.valid&&i.element.trigger("highlight",!0)}),e.firstError.element.triggerHandler("focus"))},success:function(){var e=$(this),i=$(":submit",e);return $.ajax({url:e.attr("action"),type:e.attr("method"),data:e.serializeArray(),dataType:"json",cache:!1,success:function(i){i.success?window.location.href=LT.Env.hRoot+"certification/home/?register=1&"+Math.random():-1!=i.msg.indexOf("邮箱")?$('[name="user_login"]',e).SimpleValidErrorTips(i.msg):-1!=i.msg.indexOf("手机")?$('[name="h_tel"]',e).SimpleValidErrorTips(i.msg):$.dialog.error(i.msg)},mask:i}),!1}}),o.valid({type:{name:"change",callback:function(e){var i=$(this).closest(".valid-row");i.find(".valid-tips-error").remove(),!e.valid&&$('<span class="valid-tips-error"><i class="icon-16 icon-danger"></i>'+e.customErrorMsg+"</span>").appendTo(i)}},scan:function(e){e.valid?o.find(".text-error").removeClass("text-error"):($.each(e.result,function(e,i){!i.valid&&i.element.trigger("highlight",!0)}),e.firstError.element.triggerHandler("focus"))},success:function(){var e=$(this),i=$(":submit",e),a=$("[name=user_login]",e).val(),r=$("[name=user_pwd]",e).val(),t=$('[data-selector="validate-code"]',e).val();return $.ajax({url:e.attr("action"),type:e.attr("method"),data:{user_login:a,isMd5:1,user_pwd:LT.String.md5(r),user_kind:2,rand:t},dataType:"json",cache:!1,success:function(e){var i,a,r;1==e.flag?(i=(new Date).getTime(),a=LT.String.getQuery("url"),r=null==a?"http://www.liepin.com/home/?time="+i:a,window.location.href=r):(e.msg&&e.msg.indexOf("验证码")>=0?o.find('[data-selector="validate-code"]').SimpleValidErrorTips(e.msg):o.find('[name="user_login"]').SimpleValidErrorTips(e.msg),$("img.validcode",o).attr("src","/image/randomcode4Login/?"+Math.random()))},mask:i}),!1}}),$("[validate-rules]",o).SimpleValidTips(),$("[validate-rules]",s).SimpleValidTips();var e=window.location.href;LT.String.getQuery("default",e)&&t.find('.ui-tab-control li[data-name="hlogin"]').trigger("click")}),e=$(".ui-tab-control li",t),i=$(".ui-tab-container .ui-tab-toggle",t),a=0,e.bind("click",function(){if($(this).hasClass("active"))return!1;var r=e.filter(".active").removeClass("active"),t=r.index();$(this).addClass("active"),i.addClass("hide").eq(t).removeClass("hide"),a||(o.PlaceholderUI(),a=1),$("img.validcode").trigger("click")})});